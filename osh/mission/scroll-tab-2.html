<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no,viewport-fit=cover" />
    <title>테스트</title>
    <link href="../../js_static/css/front.min.css" rel="stylesheet" />
    <style>
      .box {
        height: 100vh;
      }
      .box:nth-child(1) {
        background: red;
      }
      .box:nth-child(2) {
        background: orange;
      }
      .box:nth-child(3) {
        background: yellow;
      }
      .box:nth-child(4) {
        background: green;
      }
      .box:nth-child(5) {
        background: blue;
      }
      .box:nth-child(6) {
        background: darkblue;
      }
      .box:nth-child(7) {
        background: purple;
      }
      .tab-line {
        transition: 0.3s;
      }
    </style>
  </head>
  <body>
    <div class="page">
      <div class="page-head">
        <div>
          <h1>scroll animate</h1>
        </div>
      </div>
      <div class="page-body">
        <div class="tab-line-menu tab-fixed">
          <div class="tab-inner">
            <i class="tab-line" aria-hidden="true"></i>
            <ul class="tab-list">
              <li class="tab"><a href="#">red</a></li>
              <li class="tab"><a href="#">orange</a></li>
              <li class="tab"><a href="#">yellow</a></li>
              <li class="tab"><a href="#">green</a></li>
              <li class="tab"><a href="#">blue</a></li>
              <li class="tab"><a href="#">darkblue</a></li>
              <li class="tab"><a href="#">purple</a></li>
            </ul>
          </div>
        </div>
        <div class="section">
          <ul class="txt-list">
            <li class="dot">탭을 클릭하면 해당하는 box까지 스크롤</li>
            <li class="dot">단, header나 tab에 box의상단이 가려지면 안됨</li>
            <li class="dot">해당 박스에 이동하면 탭도 활성화표시</li>
            <li class="dot">꼭 1개는 탭이 활성화되야하며, 1개만 활성화되야함(2개이상 안됨)</li>
            <li class="dot">힌트. 클릭 이벤트로 활성화해서는 안된다</li>
          </ul>
          <br />
          <div>
            <div class="box box1"></div>
            <div class="box"></div>
            <div class="box"></div>
            <div class="box"></div>
            <div class="box"></div>
            <div class="box"></div>
            <div class="box"></div>
          </div>
          <br />
          <br />
          <br />
          <br />
          <br />
          <br />
          <br />
          <br />
        </div>
      </div>
    </div>

    <script type="text/javascript" src="../../js_static/js/jquery-3.6.0.min.js"></script>
    <script>
      function jqSlide() {
        const $tab = $('.tab');
        let $posY = [];
        let cnt = 0;

        function updatePosY() {
          $posY = [];
          for (let i = 0; i < $tab.length; i++) {
            $posY[i] = $('.box').eq(i).offset().top;
          }
        } //posY 값 구하기

        updatePosY();

        $(window).resize(function () {
          updatePosY();
        });

        $('.tab-line-menu .tab').click(function (e) {
          e.preventDefault();
          cnt = $(this).index();
          $('html,body').animate({ scrollTop: $posY[cnt] }, 500);
        });

        const bodyOffset = $('.box').offset().top;
        $(window).scroll(function () {
          if ($(document).scrollTop() > bodyOffset.top) {
            $('.tab-line-menu .tab').addClass('scroll');
          } else {
            $('.tab-line-menu .tab').removeClass('scroll');
          }
        });
        // $(document).scroll(function () {
        //   // 스크롤할 때마다 각 섹션의 꼭대기 좌표와 현재 스크롤 위치를 받고 비교한다.
        //   // 그 차이가 20 이하면 모든 .dot의 active 클래스를 삭제한 뒤
        //   // 처음 .dot에 부여했던 속성인 data-scroll 이 해당 id인 곳을 찾아 active 클래스를 부여한다.
        //   if ($('.tab-line-menu .tab').offset().top - $(window).scrollTop() < 20) {
        //     $(this).removeClass('active');
        //   } else {
        //     $(this).addClass('active');
        //   }
        // });
      }
      jqSlide();
      /*
      $(window).scroll() : 브라우저 창(window)에 대한 스크롤 이벤트를 처리
      $(document).scroll() : 문서(document) 전체에 대한 스크롤 이벤트를 처리
      .scrollTop() : 선택한 요소의 스크롤바 수직 위치를 반환하거나 스크롤바 수직 위치를 정함
       */
    </script>
  </body>
</html>
